import{u as L,r as x,j as e,a as I}from"./index-07a75f65.js";import{s as M}from"./search-e4261d9d.js";import{r as f}from"./index-fc64520c.js";import"./axios-7d4ad366.js";import{S as A}from"./sweetalert2.all-154063ec.js";import{P as E}from"./pencil-71b2e4ba.js";import{a as b}from"./axios-82afda87.js";import{T as H}from"./trash-755fbf92.js";const U=[{Header:"Name",accessor:a=>`${a.first_name} ${a.last_name}`,id:"name"},{Header:"Email",accessor:"email"},{Header:"Position",accessor:"position"},{Header:"Office",accessor:a=>_(a.office),id:"office"},{Header:"Action",accessor:"is_active"}];function _(a){const c=JSON.parse(localStorage.getItem("offices")||"").find(m=>m.id===a);return c?c.name:"N/A"}function $({search:a,data:h,getAllUsers:c}){const m=L(),{getTableProps:p,getTableBodyProps:w,headerGroups:v,prepareRow:y,page:g,state:j,setGlobalFilter:u,gotoPage:t,nextPage:d,previousPage:l,canPreviousPage:C,canNextPage:P,pageCount:n,setPageSize:B}=f.useTable({columns:U,data:h},f.useGlobalFilter,f.useSortBy,f.usePagination),{pageIndex:i}=j;return x.useEffect(()=>{B(10)},[]),x.useEffect(()=>{u(a)},[a]),e.jsxs("div",{className:" flex flex-col h-full w-full justify-between",children:[e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("table",{...p(),className:"w-full text-xs font-light table-fixed",children:e.jsx("thead",{className:"text-violet1 h-[20px]",children:v.map(o=>e.jsx("tr",{...o.getHeaderGroupProps(),className:"border-b border-[#00000013] text-sm",children:o.headers.map(s=>e.jsxs("th",{...s.getHeaderProps(s.getSortByToggleProps()),className:"pl-4 py-2 text-left truncate",children:[s.render("Header"),e.jsx("span",{children:s.isSorted?s.isSortedDesc?e.jsx("span",{children:"▼"}):e.jsx("span",{children:"▲"}):""})]}))}))})}),e.jsx("div",{className:"overflow-y-auto overflow-x-hidden  min-h-[300px] h-full pb-10 pr ",children:e.jsx("table",{className:"w-full text-xs font-light table-fixed",children:e.jsx("tbody",{...w(),className:"overflow-hidden w-full",children:g.map(o=>(y(o),e.jsx("tr",{...o.getRowProps(),className:"hover:bg-blue3/10 h-10 border-b border-[#00000013] text-sm font-medium",children:o.cells.map(s=>s.column.id!="is_active"?e.jsxs("td",{className:"h-10 pl-4 py-4 text-left truncate",children:[" ",s.render("Cell")]},s.column.id):e.jsxs("td",{className:" box-border relative h-full w-full  items-center   py-4 sm:py-2 text-center flex gap-3 sm:gap-1 justify-between sm:flex-col",children:[e.jsxs("button",{className:"rounded-[4px]   border-[1px] text-xs w-1/2 border-textY bg-bgY text-textY font-md px-2 py-1 sm:py-1 sm:px-1 hover:bg-opacity-20 sm:items-center sm:justify-center",onClick:()=>{localStorage.setItem("selectedUser",JSON.stringify(o.original)),m("/dts/admin/user/update/")},children:[e.jsx(E,{className:" h-2 w-2 hidden sm:flex"}),e.jsx("p",{className:" sm:hidden truncate ",children:"UPDATE"})]}),e.jsxs("button",{className:" rounded-[4px] border-[1px] w-1/2  hover:bg-opacity-50 text-xs border-textR bg-bgR text-textR font-md px-2 py-1 sm:px-1 sm:py-1",onClick:()=>{A.fire({icon:"warning",title:"Are you sure you want to deactivate this user?",showDenyButton:!0,showConfirmButton:!0,confirmButtonColor:"green",confirmButtonText:"Confirm",denyButtonText:"Cancel"}).then(r=>{if(r.isConfirmed){let N=o.original.id;b.get("users/user/"+N+"/",{headers:{Authorization:`Token ${localStorage.getItem("keys")}`}}).then(k=>{let T=k.data;T.is_active=!1,b.put("users/update/"+N+"/",T,{headers:{Authorization:`Token ${localStorage.getItem("keys")}`}}).then(S=>{A.fire({icon:"success",title:"You have successfully deactivated this user!",showConfirmButton:!1,timer:1500}),console.log(S),c()}).catch(S=>{console.log(S)})}).catch(k=>{console.log(k)}),console.log("Your ID is ",N)}})},children:[e.jsx(H,{className:" h-2 w-2 hidden sm:flex"}),e.jsx("p",{className:" sm:hidden truncate",children:"DEACTIVATE"})]})]},s.column.id))})))})})})]}),e.jsxs("div",{className:" hidden sm:flex  h-[10%] k w-full items-center bottom-0 self-center mb-2  justify-center gap-4 sm:gap-2 mt-2 bg-blueTable-100 text-center",children:[e.jsx("button",{onClick:()=>l(),disabled:!C,className:`className="flex items-center gap-2 px-6 sm:px-3 sm:p-3 py-3 font-sans text-xs font-bold text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none hover:bg-gray-900/10 active:bg-orange\r
                                    disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})}),e.jsxs("p",{className:" text-xs",children:[" ",e.jsxs("b",{children:[i+1," "]})," / ",n]}),e.jsx("button",{onClick:()=>d(),disabled:!P,className:`flex items-center gap-2 px-6 sm:px-3 sm:p-3 py-3 font-sans text-xs font-bold text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none hover:bg-gray-900/10 active:bg-orange\r
                                    disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none`,type:"button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"})})})]}),e.jsxs("div",{className:" sm:hidden  h-[10%] k w-full items-center bottom-0 self-center mb-2 flex justify-center gap-4 sm:gap-2 mt-2 bg-blueTable-100 text-center",children:[e.jsx("button",{onClick:()=>l(),disabled:!C,className:`className="flex items-center gap-2 px-6 sm:px-3 sm:p-3 py-3 font-sans text-xs font-bold text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none hover:bg-gray-900/10 active:bg-orange\r
                                    disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})}),i>2&&n>5&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>t(0),className:" px-3 py-1 border h-9 max-h-[40px] w-9 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10  active:bg-orange disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none",children:"1"}),e.jsx("span",{className:"px-3 py-1",children:"..."})]}),Array.from({length:Math.min(5,n)},(o,s)=>{let r;return n<=5||i<3?r=s:i>n-4?r=n-5+s:r=i-2+s,e.jsx("button",{onClick:()=>t(r),className:`px-3 py-1 border  ${i===r?"h-9 max-h-[40px] w-9 max-w-[40px] select-none rounded-lg bg-orange text-center align-middle font-sans text-xs font-medium uppercase text-white shadow-md shadow-gray-900/10 transition-all hover:shadow-lg hover:shadow-orange focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none":"h-9 max-h-[40px] w-9 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10  active:bg-orange disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"}`,children:r+1},r)}),i<n-3&&n>5&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-3 py-1",children:"..."}),e.jsx("button",{onClick:()=>t(n-1),className:" px-3 py-1 border h-9 max-h-[40px] w-9 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10  active:bg-orange disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none",children:n})]}),e.jsx("button",{onClick:()=>d(),disabled:!P,className:`flex items-center gap-2 px-6 sm:px-3 sm:p-3 py-3 font-sans text-xs font-bold text-center text-gray-900 uppercase align-middle transition-all rounded-lg select-none hover:bg-gray-900/10 active:bg-orange\r
                                    disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none`,type:"button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"})})})]})]})}const J=()=>{const a=L(),h=I(),m=new URLSearchParams(h.search).get("search"),[p,w]=x.useState(m),[v,y]=x.useState([]),g=()=>{b.get("users/all",{headers:{Authorization:`Token ${localStorage.getItem("keys")}`}}).then(t=>{const d=t.data.filter(l=>l.is_active==!0&&l.is_staff==!1);y(d)}).catch(t=>{console.log(t)})},j=()=>{b.get("office/all",{headers:{Authorization:`Token ${localStorage.getItem("keys")}`}}).then(t=>{const d=t.data.map(l=>({id:l.officeID,name:l.name}));localStorage.setItem("offices",JSON.stringify(d))}).catch(t=>{console.log(t)})};x.useEffect(()=>{g(),j()},[]);const u=t=>{w(t.target.value),window.history.pushState(null,"",`/dts/admin/user?search=${t.target.value}`)};return e.jsx("div",{className:"  w-full h-[200vh] bg-blue3 flex flex-col  items-center ",children:e.jsx("div",{className:" h-[100vh] w-full flex  items-center justify-center",children:e.jsxs("div",{className:" w-[90%] h-[80%] sm:h-[95%] sm:w-[90%]  overflow-hidden bg-white rounded-md drop-shadow-glow flex flex-col p-10 sm:p-5 gap-10 sm:gap-5 ",children:[e.jsxs("div",{className:" sm:gap-5 flex flex-row sm:flex-col items-center w-full sm:items-start justify-between",children:[e.jsxs("div",{className:"div1",children:[e.jsxs("h1",{className:"text-black font-poppins font-bold  w-[200px] text-lg eading-normal tracking-tight",children:[" ","User Management"," "]}),e.jsxs("p",{className:"text-teal-500 font-poppins text-m text-base font-normal leading-normal tracking-tight ",children:[" ","Active Members"]})]}),e.jsxs("div",{className:"  flex sm:flex-col items-center gap-5 sm:justify-between w-full justify-end  relative sm:gap-5 sm:items-start  ",children:[e.jsxs("button",{className:`\r
                            rounded-[5px] truncate border-2 border-textG hover:bg-bgG/10 transition-all duration-200 bg-bgG  text-textG px-5 py-1 font-medium text-xs\r
                        `,onClick:()=>{a("/dts/admin/user/add")},children:[" ","+ Add User"]}),e.jsxs("div",{className:"relative px-3 py-1 border-border border  flex items-center w-[80%] sm:w-full bg-bgW rounded-md m-0  max-w-[200px] sm:max-w-full",children:[e.jsx("input",{value:p,onChange:u,placeholder:"Search...",className:"outline-none w-full bg-bgW text-xs pl-7 text-gray-900 py-1 ",type:"search"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none mr-7px-4",children:e.jsx("img",{src:M,alt:"Search",className:"h-5 w-5"})})]})]})]}),e.jsx("div",{className:"flex-col max-h-full h-full overflow-hidden ",children:e.jsx($,{getAllUsers:g,data:v,search:p,handleSearch:u})})]})})})};export{J as default};
